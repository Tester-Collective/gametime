<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" class="dark">
<head>
    <meta charset="UTF-8">
    <title>Game Detail</title>
    <link rel="stylesheet" href="/output.css">
</head>
<body class="flex items-center justify-center bg-tokyo-night-bg text-white">
    <div th:include="navbar::navbar"></div>
    <div class="py-8 px-10 md:py-16 antialiased mt-20">
        <div class="max-w-screen-xl px-4 mx-auto 2xl:px-0">
            <div class="lg:grid lg:grid-cols-2 lg:gap-8 xl:gap-16">
                <div class="relative shrink-0 w-full h-full mx-auto justify-center items-center overflow-hidden border-gray-600 md:max-w-screen-md">
                    <img class="w-full h-full object-cover absolute inset-0" th:src="@{/image/{name}(name=${game.imageName})}" alt="" />
                </div>

                <div class="mt-6 sm:mt-8 lg:mt-0">
                    <p th:text="${game.category.getName()}" class="text-gray-500 text-xs overflow-y-auto max-h-4 max-w-52 mb-2 pr-3">
                    </p>
                    <div class="flex flex-row items-center">
                        <p
                            class="text-2xl font-semibold text-white"
                            th:text="${game.title}"
                        ></p>
                        <p class="ml-3">
                           <span th:if="${game.platform == 'PS5'}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-playstation" viewBox="0 0 16 16">
                                    <path d="M15.858 11.451c-.313.395-1.079.676-1.079.676l-5.696 2.046v-1.509l4.192-1.493c.476-.17.549-.412.162-.538-.386-.127-1.085-.09-1.56.08l-2.794.984v-1.566l.161-.054s.807-.286 1.942-.412c1.135-.125 2.525.017 3.616.43 1.23.39 1.368.962 1.056 1.356M9.625 8.883v-3.86c0-.453-.083-.87-.508-.988-.326-.105-.528.198-.528.65v9.664l-2.606-.827V2c1.108.206 2.722.692 3.59.985 2.207.757 2.955 1.7 2.955 3.825 0 2.071-1.278 2.856-2.903 2.072Zm-8.424 3.625C-.061 12.15-.271 11.41.304 10.984c.532-.394 1.436-.69 1.436-.69l3.737-1.33v1.515l-2.69.963c-.474.17-.547.411-.161.538.386.126 1.085.09 1.56-.08l1.29-.469v1.356l-.257.043a8.45 8.45 0 0 1-4.018-.323Z"/>
                                </svg>
                           </span>
                            <span th:if="${game.platform == 'PC'}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-pc-display" viewBox="0 0 16 16">
                                    <path d="M8 1a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v14a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1zm1 13.5a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0m2 0a.5.5 0 1 0 1 0 .5.5 0 0 0-1 0M9.5 1a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zM9 3.5a.5.5 0 0 0 .5.5h5a.5.5 0 0 0 0-1h-5a.5.5 0 0 0-.5.5M1.5 2A1.5 1.5 0 0 0 0 3.5v7A1.5 1.5 0 0 0 1.5 12H6v2h-.5a.5.5 0 0 0 0 1H7v-4H1.5a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .5-.5H7V2z"/>
                                </svg>
                            </span>
                            <span th:if="${game.platform == 'XBOX'}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-xbox" viewBox="0 0 16 16">
                                    <path d="M7.202 15.967a8 8 0 0 1-3.552-1.26c-.898-.585-1.101-.826-1.101-1.306 0-.965 1.062-2.656 2.879-4.583C6.459 7.723 7.897 6.44 8.052 6.475c.302.068 2.718 2.423 3.622 3.531 1.43 1.753 2.088 3.189 1.754 3.829-.254.486-1.83 1.437-2.987 1.802-.954.301-2.207.429-3.239.33m-5.866-3.57C.589 11.253.212 10.127.03 8.497c-.06-.539-.038-.846.137-1.95.218-1.377 1.002-2.97 1.945-3.95.401-.417.437-.427.926-.263.595.2 1.23.638 2.213 1.528l.574.519-.313.385C4.056 6.553 2.52 9.086 1.94 10.653c-.315.852-.442 1.707-.306 2.063.091.24.007.15-.3-.319Zm13.101.195c.074-.36-.019-1.02-.238-1.687-.473-1.443-2.055-4.128-3.508-5.953l-.457-.575.494-.454c.646-.593 1.095-.948 1.58-1.25.381-.237.927-.448 1.161-.448.145 0 .654.528 1.065 1.104a8.4 8.4 0 0 1 1.343 3.102c.153.728.166 2.286.024 3.012a9.5 9.5 0 0 1-.6 1.893c-.179.393-.624 1.156-.82 1.404-.1.128-.1.127-.043-.148ZM7.335 1.952c-.67-.34-1.704-.705-2.276-.803a4 4 0 0 0-.759-.043c-.471.024-.45 0 .306-.358A7.8 7.8 0 0 1 6.47.128c.8-.169 2.306-.17 3.094-.005.85.18 1.853.552 2.418.9l.168.103-.385-.02c-.766-.038-1.88.27-3.078.853-.361.176-.676.316-.699.312a12 12 0 0 1-.654-.319Z"/>
                                </svg>
                            </span>
                            <span th:if="${game.platform == 'SWITCH'}">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-nintendo-switch" viewBox="0 0 16 16">
                                    <path d="M9.34 8.005c0-4.38.01-7.972.023-7.982C9.373.01 10.036 0 10.831 0c1.153 0 1.51.01 1.743.05 1.73.298 3.045 1.6 3.373 3.326.046.242.053.809.053 4.61 0 4.06.005 4.537-.123 4.976-.022.076-.048.15-.08.242a4.14 4.14 0 0 1-3.426 2.767c-.317.033-2.889.046-2.978.013-.05-.02-.053-.752-.053-7.979m4.675.269a1.62 1.62 0 0 0-1.113-1.034 1.61 1.61 0 0 0-1.938 1.073 1.9 1.9 0 0 0-.014.935 1.63 1.63 0 0 0 1.952 1.107c.51-.136.908-.504 1.11-1.028.11-.285.113-.742.003-1.053M3.71 3.317c-.208.04-.526.199-.695.348-.348.301-.52.729-.494 1.232.013.262.03.332.136.544.155.321.39.556.712.715.222.11.278.123.567.133.261.01.354 0 .53-.06.719-.242 1.153-.94 1.03-1.656-.142-.852-.95-1.422-1.786-1.256"/>
                                    <path d="M3.425.053a4.14 4.14 0 0 0-3.28 3.015C0 3.628-.01 3.956.005 8.3c.01 3.99.014 4.082.08 4.39.368 1.66 1.548 2.844 3.224 3.235.22.05.497.06 2.29.07 1.856.012 2.048.009 2.097-.04.05-.05.053-.69.053-7.94 0-5.374-.01-7.906-.033-7.952-.033-.06-.09-.063-2.03-.06-1.578.004-2.052.014-2.26.05Zm3 14.665-1.35-.016c-1.242-.013-1.375-.02-1.623-.083a2.81 2.81 0 0 1-2.08-2.167c-.074-.335-.074-8.579-.004-8.907a2.85 2.85 0 0 1 1.716-2.05c.438-.176.64-.196 2.058-.2l1.282-.003v13.426Z"/>
                                </svg>
                            </span>
                            <span th:if="${game.platform == 'MOBILE'}">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-7 h-7">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" />
                            </svg>
                        </span>
                        </p>
                    </div>
                    <div class="mt-2 sm:items-center sm:gap-4 sm:flex">
                        <p
                            class="text-3xl font-extrabold text-white"
                            th:text="'Rp' + ${#numbers.formatDecimal(game.price, 3, 'POINT', 0, 'COMMA')}"
                        >
                        </p>
                        <div class="flex items-center gap-1">
                            <p>
                                <span th:each="i : ${#numbers.sequence(1, 5)}"
                                      th:classappend="${i <= avgRatingByGame} ? 'text-yellow-400' : 'text-gray-300'">&#9733;
                                </span>
                            </p>
                            <p>
                                <span th:text="'(' + ${avgRatingByGame} + ')'" class="text-md font-medium text-gray-600">
                                </span>
                            </p>

                        </div>
                    </div>
                    <div class="mt-2 sm:items-center sm:gap-4 sm:flex">
                        <p th:text="'by ' + ${game.seller.username}" class="text-lg font-semibold text-gray-500">
                        </p>
                    </div>

                    <div class="mt-6 sm:gap-4 sm:items-center sm:flex sm:mt-8 ">
                        <form th:action="@{/cart/add/{id}(id=${game.id})}" method="POST">
                            <button
                                    class="text-white mt-4 sm:mt-0 font-medium rounded-lg text-sm px-5 py-2.5 bg-blue-600 hover:bg-blue-700 flex items-center justify-center"
                                    type="submit"
                            >
                                <svg
                                        class="w-5 h-5 -ms-2 me-2"
                                        aria-hidden="true"
                                        xmlns="http://www.w3.org/2000/svg"
                                        width="24"
                                        height="24"
                                        fill="none"
                                        viewBox="0 0 24 24"
                                >
                                    <path
                                            stroke="currentColor"
                                            stroke-linecap="round"
                                            stroke-linejoin="round"
                                            stroke-width="2"
                                            d="M4 4h1.5L8 16m0 0h8m-8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm8 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4Zm.75-3H7.5M11 7H6.312M17 4v6m-3-3h6"
                                    />
                                </svg>
                                Add to cart
                            </button>
                        </form>
                    </div>

                    <hr class="my-6 md:my-8 border-gray-500" />

                    <p class="mb-6 text-gray-400" th:text="${game.getDescription()}">
                    </p>

                </div>
            </div>
        </div>

        <section class="bg-white py-8 antialiased dark:bg-tokyo-night-bg md:py-16">
            <div class="mx-auto max-w-screen-xl px-4 2xl:px-0">
                <div class="my-4 gap-8 sm:flex sm:items-start md:my-4">
                    <div class="shrink-0 space-y-4">
                        <p class="mb-3 text-3xl font-semibold leading-none text-gray-900 dark:text-white">
                            <span th:text="Reviews"></span>
                        </p>
                        <button type="button" class="mt-5 rounded-lg bg-primary-700 px-5 py-2.5 text-sm font-medium text-white hover:bg-primary-800 focus:outline-none focus:ring-4 focus:ring-primary-300 dark:bg-primary-600 dark:hover:bg-primary-700 dark:focus:ring-primary-800">
                            <a th:href="@{/game/buyer/details/{gameId}/addReview(gameId=${game.id})}">
                                Write a review
                            </a>
                        </button>
                    </div>
                </div>

                <div class="mt-3 divide-y divide-gray-200">
                    <div th:each="review : ${reviews}" class="gap-3 pb-6 pt-6 grid grid-cols-2">
                        <div class="flex items-center gap-0.5 col-span-2">
                            <div class="flex items-center gap-0.5">
                                    <span th:each="i : ${#numbers.sequence(1, 5)}"
                                          th:classappend="${i <= review.rating} ? 'text-yellow-400' : 'text-gray-300'">&#9733;
                                    </span>
                            </div>
                        </div>
                        <div class="shrink-0 space-y-2 sm:w-48 md:w-72">
                            <div class="space-y-0.5">
                                <p class="text-base font-semibold text-white">
                                    <span th:text="${review.user.username}">
                                    </span>
                                </p>
                                <p class="text-sm font-normal text-gray-500 dark:text-gray-400">
                                    <span th:text="${review.getFormattedDate()}"></span>
                                </p>
                            </div>

                            <div class="inline-flex items-center gap-1">
                                <svg class="h-5 w-5 text-primary-700 dark:text-primary-500" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" viewBox="0 0 24 24">
                                    <path
                                            fill-rule="evenodd"
                                            d="M12 2c-.791 0-1.55.314-2.11.874l-.893.893a.985.985 0 0 1-.696.288H7.04A2.984 2.984 0 0 0 4.055 7.04v1.262a.986.986 0 0 1-.288.696l-.893.893a2.984 2.984 0 0 0 0 4.22l.893.893a.985.985 0 0 1 .288.696v1.262a2.984 2.984 0 0 0 2.984 2.984h1.262c.261 0 .512.104.696.288l.893.893a2.984 2.984 0 0 0 4.22 0l.893-.893a.985.985 0 0 1 .696-.288h1.262a2.984 2.984 0 0 0 2.984-2.984V15.7c0-.261.104-.512.288-.696l.893-.893a2.984 2.984 0 0 0 0-4.22l-.893-.893a.985.985 0 0 1-.288-.696V7.04a2.984 2.984 0 0 0-2.984-2.984h-1.262a.985.985 0 0 1-.696-.288l-.893-.893A2.984 2.984 0 0 0 12 2Zm3.683 7.73a1 1 0 1 0-1.414-1.413l-4.253 4.253-1.277-1.277a1 1 0 0 0-1.415 1.414l1.985 1.984a1 1 0 0 0 1.414 0l4.96-4.96Z"
                                            clip-rule="evenodd"
                                    />
                                </svg>
                                <p class="text-sm font-medium text-gray-900 dark:text-white">Verified purchase</p>
                            </div>
                        </div>

                        <div class="space-y-0.5 min-w-0 flex-1 sm:mt-0 flex-col">
                            <p class="text-base font-semibold text-white">
                                <span th:text="${review.reviewTitle}">
                                </span>
                            </p>
                            <p class="text-base font-normal text-gray-500 dark:text-gray-400">
                                <span th:text="${review.reviewText}">
                                </span>
                            </p>

                            <div class="flex items-center gap-4">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</body>
</html>
